# 파이썬으로 배우는 웹 크롤러 
---

# Step 1      

## PART 01 : 크롤러의 정의     
---
### 크롤러(Crawler)        

- API를 제공하지 않는 웹사이트들의 데이터 수집이 가능 => 100 정확한 수집은 못함        
   => 하지만 데이터를 가공 => 100에 **가까운** 데이터 수집은 가능          
- 웹에 대해 상당히 의존적        
    => 수집하고자 하는 사이트에 따라 만드는 방식이 다름     
- 알고리즘에 의해 인터넷을 탐색하여 데이터를 수집하는 프로그램   
- 스크래퍼, 봇, 스파이더, 지능에이전트등... 중 많이 사용 =>  **크롤러 & 스크래퍼**   
- 크롤러가 크롤링한다 => ( 크롤링 + 스크래핑 )
    - 크롤링(Crawling)       
        - 크롤러가 동작          
            => 페이지를 돌아다니는 행위     
        - 대표적인 예      
            - 검색엔진 => 다양한 페이지를 수집후 검색 키워드에 맞게 사용자에게 제공      
    - 스크래핑     
        - 스크래퍼가 동작     
            => 특정페이지를 수집하는행위      

- 크롤러를 만들어야하는 이유 
    1. 방대해진 데이터의 생산 => 데이터를 수집하기 어려움 
    2. 데이터의 사용 => 미래 예측 분야 (인공지능)

- 데이터 수집 방법 
    - API : 특정 서비스가 데이터를 제공하는 방법 
    - API를 제공하지 않아 사용이 불가능한 데이터 수집 => 크롤러를 이용해 수집   


---

## PART 02 : 클라이언트 & 서버의 정의      
---    
### 클라이언트(Client)        
- 데이터, 서비스를 요청하는 프로그램     
    => 요청한 데이터를 보여주기도 함(그게 웹 브라우저)     
- 데이터를 요청하여 받아온 데이터를 사용자에게 제공 
- 우리가 사용하는 각종 앱, 프로그램, 웹 브라우저 => 클라이언트 프로그램      


### 서버(Server)        

- 인터넷을 통해 연결된 서버는 클라이언트가 필요한 데이터를 제공해주는 역활하는 프로그램           
- 서버 없이 클라이언트가 존재할 수 없음! 특히 웹은 서버 없이는 절대 동작이 불가능     
    - 도메인 창에 주소를 치고 사이트에 접속하는 행위 => 서버에 접속하는 것        
- 보이지 않는 곳에서 클라이언트의 처리를 도와주는것 =>  서버  

- 서버의 종류 
    - 영상 
        - 다른서버와는 다르게 한번에 데이터를 전송하는 것이 아닌 일정량을 분할하여 전송 => **스트리밍**   
            - 예 ) 유튜브 
    - 파일
        - 예) P2P, 토렌트, 드라이브, FTP, SFTP 등등.... 
    - 도메인
    - 이메일
    - 채팅 및 음성
    - 게임 
    - 웹서버
        - 웹브러우저를 통해 요청된 페이지를 받아오는 서버 
        - 동적인 페이지 , 정적인 페이지 형태로 제공 
            - 동적인 페이지 
                : 게시판과 같이 데이터가 늘어났다가 줄어드는 페이지  => 띄울때마다 다른 데이터가 뜨는 페이지
            - 정적인 페이지 
                : 항상 같은 데이터를 띄우는 페이지 


#### 클라아이언트와 서버의 관계를 정확히 이해해야하는 이유 

- 데이터를 **사용하는 목적** 에 맞게 가공하는 것이 중요      
- 크롤러를 만든다는것 **서버를 어떤 구조로 만들었는지 파악하고 유추**하는 것이 굉장히 중요       
- **서버의 응답받은 데이터를 찾고 그 데이터를 어떻게 가져오는지 판단하는 과정이 굉장히 중요**         



### 서버와 클라이언트간 통신

- 요청 메소드(Method)         
    : 4가지 타입의 요청 타입(CRUD) =>  읽기(Read), 쓰기(Create), 수정(Update), 삭제(Delete)         
- 매핑
    - 읽기(**R**ead)    => GET      
        - GET 메소드      
        : 클라이언트가 서버에 데이터를 요청할때 사용         
    - 쓰기(**C**reate)  => POST    
        - POST 메소드       
        : 특정 데이터를 추가하는 요청   => (데이터를 만들어 냄 = 데이터 베이스에 데이터를 추가)      
    - 수정(**U**pdate)  => PUT      
        - PUT 메소드   
        : 특정 데이터를 수정하라는 요청 => 데이터 베이스의 데이터를 수정     
        - 예 ) 회원정보 수정        
    - 삭제(**D**elete)  => DELETE     
        - DELETE 메소드      
        : 특정 데이터를 삭제하라는 요청 => 데이터 베이스의 데이터를 삭제        
        - 예 ) 회원정보 삭제          

- 주로 GET , POST 사용 


- 클라이언트  =>  일반헤더 + 요청헤더 + 엔티티헤더            
- 서 버       =>  일반헤더 + 응답헤더 + 엔티티헤더       
   
- 헤더(Header)
    - 일반헤더 
        - 서버와 클라이언트 간 데이터를 주고 받을 때 헤더라는 정보를 포함
    - 요청헤더 
        - 클라이언트가 서버에 데이터를 요청할 때 포함된 헤더( 문서 구성과 형식을 포함 )
    - 응답헤더
        - 클라이언트에게 응답할때 포함된 헤더( 요청과 서버의 구성을 포함 )
    - 엔티티헤더
        - 메시지의에 대한 설명을 포함하는 헤더


### URL(Uniform Resource Locator)
- URL의 구조를 잘 파악하는 것이 효율적인 크롤러를 만들수 있음 
- URL의 구조 
    - ``` 프로토콜(Http)://주소 또는 IP:포트 번호 / 리소스 경로?쿼리스트링```
        - 주소 또는 IP  : 웹사이트에 접속할 때 입력하고 들어가는 것     
        - 포트 번호 (생략가능)              
        - 리소스 경로    
            - 한 사이트에서 페이지를 옮길 때마다 다르게 표현됨 
            - 주소 다음에 (/)로 시작하는 부분 => 이 부분부터 데이터(경로)를 함께 보낼수 있음        
        - 쿼리스트링        
            - 데이터가 포함되는 부분       
            - 클라이언트가 서버에 보내는 데이터 => 리소스 경로 뒤에 붙음 **(?)로 구분**  
            - ```변수=데이터 & 변수=데이터 & 변수=데이터 ``` 형태로 엔드(&) => 데이터를 구분해서 전송       
    
    - 리소스 경로, 쿼리스트링에 데이터를 함께 보내면 데이터를 보내는데 한계가 있음  
        => 헤더의 바디를 통해 데이터를 함게 보냄(url에서 확인 불가 )=> 더 많은 데이터를 전송 가능            
        
    - Request Method POST일 경우에만 바디에 데이터가 존재 => GET의 경우 비어있음 

---
## PART 03 : 웹을 구성하는 요소   
---

### 웹페이지의 3요소        
- HTML           : 레이아웃    
- JS(JavaScript) : 기능 추가     
- CSS            : 화면을 꾸며줌     

### HTML(HyperText Markup Language)
- 하이퍼텍스트 마크업 언어 => 웹을 이루는 가장 기본이되는 요소 
- 기본 구조 

    ```html
    <!DOCTYPE html>  # html5를 명시
    <html lang="en"> # lang라는 속성을 가짐 
    <head>
        <meta charset="UTF-8"> # meta는 HTML문서의 정보를 담고 있음
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> # content => 문서의 정보
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>탭에 표시되는 제목</title>
    </head>
    <body>
        
    </body>
    </html>

    # 태그 설명   
    # 문단을 나타내는 태그 
    <p></p>
    # h태그를 이용해서 폰트크기 설정 => 수가 작을수록 폰트크기가 커짐(1-6정도)      
    <h1></h1>  
    # 리스트를 만드는 태그 => (요소 li)   
    <ul>
        <li> </li>
    </ul> 
    <ol>
        <li> </li>
    </ol> 
    # 표를 표현 
    <table>
        <tr> # 행 
            <th> </th> # 컬럼 = 가운데 정렬 + 굵은 글씨 
            <td> </td> # 컬럼 
        </tr>
    </table>   
    # 데이터를 넣는 폼 => 닫는 태그가 존재 안함  
    <input type ="" value =""> 
    # 버튼
    <button></button>      
    # 선택 리스트 생성  
    <select>    
        <option></option>    
    </select> 
    # 다른 페이지로 이동 => href는 클릭 시 이동되는 링크 
    # 1. 전체주소
    # 2. 상대경로(상대주소)
    # 3. 절대경로(절대주소) => 루트경로
    <a href="주소"></a>
    # 이미지 포함 태그 
    # alt => 해당이미지가 불러와지지 않을 때 이미지를 대체하는 글
    <img src="이미지.확장자 & 이미지 주소" alt="이미지 로딩중">
    # p 태그처럼 글을 넣을수 있음 
    # p랑 차이는 p는 엔터가 자동 적용되지만 span 태그는 옆으로 나열 
    <span></span>
    # 단순히 영역을잡고 화면 레이아웃을 만드는 역활
    # 중첩해서 사용가능 
    <div></div>
  ```

    - div가 아닌 table로 구조를 잡은 사이트는 크롤링이 조금 힘듬 
    - **id와 class속성(=셀렉터)**을 사용하지 않기 때문
    - 셀렉터의 존재 유무는 원하는데이터를 정확하게 수집가능한가 아닌가차이 
    - id와 class속성은 파싱하기 위해서 반드시 필요한 속성 => 모든 태그에 들어 갈수있는 속성 
  
### CSS(Cascading Style Sheets)
- 웹 사이트를 꾸며주는 역활

- 셀렉터(Selecter)
    - 특정요소에 접근하는 것 
        - 태그로 접근 -> 원하는 요소만 정확히 접근할 수 없음  
        - id와 class속성 접근    
            - class => 원하는 요소만 수집이 가능함       
            - id => id값은 고유하게 접근(중복사용 하지 않음) => 한 페이지에 하나     
- 복잡한 셀렉터 만들기     
    - 부모와 자식태그를 나열하면 복잡한 셀렉터를 만들수 있음     
    - 원하는 곳에 접근하는 셀렉터를 자유자재로 만들어야 크롤러를 만드는데 어려움이 없음      

### JS(JavaScript)  
 - 웹 사이트에 여러가지의 기능을 추가     
 - ```<script></script>``` 태그를 이용해서 작성    
 - 위치는 보통 body의 가장 하단   
 - 스크립트로 html로 만들수있는데 -> 이 경우 크롤링이 힘듬    


### 웹 렌더링의 원리
- DOM(The Document Object Model)
    - HTML을 시각적으로 쉽게 표현하기 위해 만든 객체
    - 문서를 구조화한 것 
    - 태그 옆 삼각형을 누르면 하위 자식구조를 볼수있는데 이를 DOM 구조라고 함
    - DOM을 이용해서 데이터에 접근한후 데이터를 수집 


